<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>Multiple differently styled clusters</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

<script src='https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.js'></script>
    <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
<script src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<link href='https://api.mapbox.com/mapbox.js/v2.4.0/mapbox.css' rel='stylesheet' />


<style>
  body { margin:0; padding:0; }
  #map { position:absolute; top:0; bottom:0; width:100%; }
</style>
</head>
<body>


<script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/leaflet.markercluster.js'></script>
<link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.css' rel='stylesheet' />
<link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-markercluster/v0.4.0/MarkerCluster.Default.css' rel='stylesheet' />
<link rel="stylesheet" href="http://code.ionicframework.com/ionicons/1.5.2/css/ionicons.min.css">

<!-- Leaflet Awesome Marker zum Designen der Marker -->
<script src="leaflet.awesome-markers.js"></script>
<script src="leaflet.awesome-markers.min.js"></script>
<link rel="stylesheet" href="leaflet.awesome-markers.css">

<!-- Leaflet Extra Marker zum Designen der Marker  -->

<script src="leaflet.extra-markers.min.js"></script>
<link rel="stylesheet" href="leaflet.extra-markers.min.css">



<div id='map'></div>

<script>

var marker;

// Creates a red marker with the coffee icon
//var redMarker = L.AwesomeMarkers.icon({
//  icon: 'coffee',
//  markerColor: 'red'
//});
//Creates a red marker with the coffee icon
//var greenMarker = L.AwesomeMarkers.icon({
//  markerColor: 'black'
//});




L.mapbox.accessToken = 'pk.eyJ1Ijoid2Flcm1lcHVtcGUiLCJhIjoiY2ltZDllMXVxMDAwenZ1bTNtYTBkN3RkbiJ9.QwIUrt30G9NZflUyXCDdEA';
// Here we don't use the second argument to map, since that would automatically
// load in non-clustered markers from the layer. Instead we add just the
// backing tileLayer, and then use the featureLayer only for its data.
var map = L.mapbox.map('map')
    .setView([49.3968, 8.667 ], 12)
    .addLayer(L.mapbox.tileLayer('mapbox.streets'));

// Since featureLayer is an asynchronous method, we use the `.on('ready'`
// call to only use its marker data once we know it is actually loaded.
L.mapbox.featureLayer()
    .loadURL('https://www.mapbox.com/mapbox.js/assets/data/stations.geojson')
    .on('ready', function(e) {
    // create a new MarkerClusterGroup that will show special-colored
    // numbers to indicate the type of rail stations it contains
    function makeGroup(color) {
      return new L.MarkerClusterGroup({
        iconCreateFunction: function(cluster) {
          return new L.DivIcon({
            iconSize: [20, 20],
            html: '<div style="text-align:center;color:#fff;background:' +
            color + '">' + cluster.getChildCount() + '</div>'
          });
        }
      }).addTo(map);
    }
    // create a marker cluster group for each type of rail station
    var groups = {
      red: makeGroup('red'),
      green: makeGroup('green'),
      orange: makeGroup('orange'),
      blue: makeGroup('blue'),
      yellow: makeGroup('yellow')
    };
    e.target.eachLayer(function(layer) {
      // add each rail station to its specific group.
      groups[layer.feature.properties.line].addLayer(layer);
    });
});

		
// Umrandung Heidelberg
var bounds = [[ 49.4349, 8.6171 ], [ 49.3587, 8.6171  ], [ 49.3587, 8.7180  ],
      							[ 49.4349, 8.7180 ]];

// Design der Umrandung
L.rectangle(bounds, {color: "#000000", weight: 2, fillColor: "transparent" }).addTo(map);

//L.marker([49.4349, 8.6171], {icon: redMarker}).addTo(map);


//Funktion, die das JSON liest und verarbeitet
    $.getJSON('/wp/list', function(data) {
        console.log(data);
        
        for (var i = 0; i < 10; i++) {
        	
        	// Erstellt grüne Marker, die durchnummeriert werden
        	var greenMarker = L.ExtraMarkers.icon({
        		icon: 'fa-number', 
        		number: i+1,
        		markerColor: 'green-light'
        	});
        	
        	// Erstellt rote Marker, die durchnummeriert werden 
        	var redMarker = L.ExtraMarkers.icon({
        		icon: 'fa-number', 
        		number: i+1,
        		markerColor: 'red'
        	});


			console.log(data[i].location);
			console.log(data[i].name);
			
			if (i <= 5)
				{
			
				 L.marker([data[i].y_koord,
							data[i].x_koord ], {icon: greenMarker}).addTo(map);
				} else {
				 L.marker([data[i].y_koord,
							data[i].x_koord ], {icon: redMarker}).addTo(map);
				}
     
        }
    });
    
    //Gibt bei einem Klick die aktuelle Position aus
    var popup = L.popup();

    function onMapClick(e) {
        popup
            .setLatLng(e.latlng)
            .setContent("Auf der Karte wurde folgender Punkt: " + e.latlng.toString() + " ausgewählt")
            .openOn(map);
    }

    map.on('click', onMapClick);
    
    
  
</script>


</body>
</html>
